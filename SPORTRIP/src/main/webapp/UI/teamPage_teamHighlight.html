<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>울산HD</title>
<link rel="stylesheet" href="./assets/css/style.css">
<script>
    function goMain(){
        document.location.href="mainPage.jsp";
    }
</script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
</head>
<body>
<header class="header header_logo">
    <a style="cursor: pointer" onclick="goMain()"><img src="./assets/images/sportrip_logo.png" alt="sportrip 로고" id="logo_img"></a>
    <a href="soccer_main.html" style="margin-left: 50px;"><img src="./assets/images/k-league_logo.svg" alt="리그" id="league_logo_img"></a>
    <div style="position: absolute; left: 50%; transform: translateX(-50%);" class="img-box">
        <img src="./assets/images/logo_img/2_울산HD.png" alt="울산" class="team_logo_img team-ulsan">
    </div>
</header>
    <div class="t_top">
        <div class="item" style="background-color: #236FB5;">
            <a href="teamPage_Player.html">선수 명단</a>
        </div>
        <div class="item" style="background-color: #236FB5;">
            <a href="teamPage_Stadium.html">경기장 소개</a>
        </div>
        <div class="item" style="background-color: #236FB5;">
            <a href="teamPage_teamIntro.html">구단 소개</a>
        </div>
        <div class="item" style="background-color: #083660;">
            <a href="teamPage_teamHighlight.html">하이라이트 경기</a>
        </div>
        <div class="item" style="background-color: #236FB5;">
            <a href="teamPage_Store.html">굿즈샵</a>
        </div>
        <div class="item" style="background-color: #236FB5;">
            <a href="teamPage_Board.html">게시판</a>
        </div>
    </div>
    <div class="highlight-container">
        <script type="text/javascript">
            $(document).ready(function() {
                const apiurl = "https://youtube.googleapis.com/youtube/v3/search?part=snippet&maxResults=9&order=date&q=%EC%9A%B8%EC%82%B0%20%ED%98%84%EB%8C%80%20%ED%95%98%EC%9D%B4%EB%9D%BC%EC%9D%B4%ED%8A%B8&type=video&videoDuration=medium&key=AIzaSyADuItf8mzFqwyrWiWKYs89YaWA7TuwdWs";
        
                function convertUTCToKST(utcStr) {
                    const date = new Date(utcStr);
                        const offset = 9 * 60; // Korea Standard Time (UTC+9) in minutes
                        const localDate = new Date(date.getTime() + offset * 60000);
                        localDate.setDate(localDate.getDate() - 1); // 하루를 빼기
        
                        const yyyy = localDate.getFullYear();
                        const mm = String(localDate.getMonth() + 1).padStart(2, '0');
                        const dd = String(localDate.getDate()).padStart(2, '0');
                        return `${yyyy}-${mm}-${dd}`;
                }
        
                function truncateTitle(title) {
                        const separatorIndex = title.indexOf('|');
                        if (separatorIndex !== -1) {
                            return title.substring(0, separatorIndex).trim();
                        }
                        return title;
                }
                
                $.ajax({
                    type: "GET",
                    dataType: "json",
                    url: apiurl,
                    contentType : "application/json",
                    success : function(data) {
                        data.items.forEach(function(element, index) {
                            const publishedDate = convertUTCToKST(element.snippet.publishedAt);
                            const truncatedTitle = truncateTitle(element.snippet.title);
                            $('.highlight-container').append('<div class="highlight-box highlight'+index+'"> <div class="highlight-video"> <iframe width="560" height="315" src="https://www.youtube.com/embed/'+element.id.videoId+'" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe> </div> <div class="info-box"> <span style="color: red; font-weight: bold;">[하이라이트]</span><br> <span>'+ truncatedTitle + '</span><br> <span> (' + publishedDate + ')</span> </div> </div>');
                        });
                    },
                    complete : function(data) {
                    },
                    error : function(xhr, status, error) {
                        console.log("유튜브 요청 에러: "+error);
                    }
                });
            });
        </script>
    </div>
</body>
</html>
